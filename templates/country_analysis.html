<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Country-wise Analysis</title>
    <link rel="shortcut icon" href="/static/img/logo4.png">

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 20px;
        }
        
        h2 {
            margin-top: 40px;
            margin-bottom: 20px;
        }
        
        #yearwiseMedalChart {
            margin-bottom: 40px;
        }
        
        #sportwiseMedalChart table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 40px;
        }
        
        #sportwiseMedalChart th,
        #sportwiseMedalChart td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        #mostSuccessfulAthletesTable {
            width: 100%;
            border-collapse: collapse;
        }
        
        #mostSuccessfulAthletesTable th,
        #mostSuccessfulAthletesTable td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
    </style>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h1>Country-wise Analysis</h1>

    
    <form method="post" id="countryAnalysisForm">
        {% csrf_token %}
        <!-- Add form elements for year and country input -->
        <label for="year">Year:</label>
        <input type="text" id="year" name="year" value="2021">
    
        <label for="country">Country:</label>
        <input type="text" id="country" name="country" value="United States">
    
        <button type="submit">Country-wise Analysis</button>
    </form>

    <form method="post">
        {% csrf_token %}
        <!-- Rest of the form fields and submit button -->
        
        <h2>Year-wise Medals</h2>
        <div id="yearwiseMedalChart"></div>
        
        <h2>Sport-wise Medals</h2>
        <div id="sportwiseMedalChart"></div>
        
        <h2>Most Successful Athletes</h2>
       
        <table>
            <tbody id="mostSuccessfulAthletesTable">
                <!-- Populate the table dynamically using JavaScript -->
            </tbody>
        </table>
    </form>


<!-- Include Plotly.js library -->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<!-- Your existing JavaScript code... -->
<script>
    // Function to get the CSRF token value from the page
    function getCSRFToken() {
        return document.querySelector('[name=csrfmiddlewaretoken]').value;
    }

      // Function to update the country analysis using the received data
      function updateCountryAnalysis(data) {
        // Get the chart div elements
        const yearwiseMedalChart = document.getElementById("yearwiseMedalChart");
        const sportwiseMedalChart = document.getElementById("sportwiseMedalChart");
        const mostSuccessfulAthletesTable = document.getElementById("mostSuccessfulAthletesTable");

        // Update Year-wise Medals chart
        const yearwiseMedalData = data.yearwiseMedal;
        const yearwiseMedalLayout = {
            title: 'Year-wise Medals',
            xaxis: {
                title: 'Year'
            },
            yaxis: {
                title: 'Medals'
            }
        };
        Plotly.newPlot(yearwiseMedalChart, yearwiseMedalData, yearwiseMedalLayout);

        // Update Sport-wise Medals chart
        const sportwiseMedalData = data.sportwiseMedal;
        const sportwiseMedalLayout = {
            title: 'Sport-wise Medals',
            xaxis: {
                title: 'Year'
            },
            yaxis: {
                title: 'Sport'
            }
        };
        Plotly.newPlot(sportwiseMedalChart, sportwiseMedalData, sportwiseMedalLayout);

        // Update Most Successful Athletes table
        const tableData = data.mostSuccessfulAthletes;
        let tableHtml = "<tr><th>Name</th><th>Medals</th><th>Sport</th></tr>";
        tableData.forEach(row => {
            tableHtml += `<tr><td>${row.Name}</td><td>${row.Medals}</td><td>${row.Sport}</td></tr>`;
        });
        mostSuccessfulAthletesTable.innerHTML = tableHtml;
    }


    // Function to fetch the country analysis data
    function fetchCountryAnalysis(year, country) {
        const csrfToken = getCSRFToken();

        fetch("/country_analysis/", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "X-CSRFToken": csrfToken
            },
            body: JSON.stringify({
                year: year,
                country: country,
            }),
        })
        .then(response => response.json())
        .then(data => {
            updateCountryAnalysis(data);
        })
        .catch(error => {
            console.log(error);
        });
    }

    // Function to handle form submission
    function handleFormSubmit(event) {
        event.preventDefault(); // Prevent form submission

        const yearInput = document.getElementById("year").value;
        const countryInput = document.getElementById("country").value;
        fetchCountryAnalysis(yearInput, countryInput);
    }

    // Add event listener to the form for form submission
    const form = document.getElementById("countryAnalysisForm");
    form.addEventListener("submit", handleFormSubmit);

    // Call the fetchCountryAnalysis function with default values on page load
    fetchCountryAnalysis('2021', 'United States');
</script>


<<<<<<< HEAD
    <h2>Most Successful Athletes</h2>
    <table>
        <tbody id="mostSuccessfulAthletesTable">
            <!-- Populate the table dynamically using JavaScript -->
        </tbody>
    </table>
    <div class="form-group">
        <label for="country">Select country:</label>
        <input type="text" id="country" name="country" placeholder="Enter country">
    </div>
    <div class="paragraph2">
        <button type="submit">Show</button>
    </div>
    <!-- Include any necessary JavaScript code here -->
    <script>
        // Function to update the country analysis using the received data
        function updateCountryAnalysis(data) {
            // Update year-wise medal chart
            const yearwiseMedalChart = document.getElementById("yearwiseMedalChart");
            const yearwiseMedalData = data.yearwiseMedal;
            const yearwiseMedalFig = {
                x: yearwiseMedalData.Year,
                y: yearwiseMedalData.Medal,
                type: 'line'
            };
            const yearwiseMedalLayout = {
                title: 'Year-wise Medals',
                xaxis: { title: 'Year' },
                yaxis: { title: 'Medal Count' }
            };
            Plotly.newPlot(yearwiseMedalChart, [yearwiseMedalFig], yearwiseMedalLayout);
    
            
    </script>
    
    
=======

>>>>>>> a92db9f0e9eb27fc4bc2104a0c19575010feeb4b
</body>
</html>
